<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.9.0.js"></script>
    <!-- <script>
      window.setInterval('refresh()', 10000); 	
      // Call a function every 10000 milliseconds 
      // (OR 10 seconds).
  
      // Refresh or reload page.
      function refresh() {
          window .location.reload();
      }
  </script> -->
    <title>NOISE MONITOR</title>
  </head>
  <div>
  <body>
      
    <div>
      <div class="chart-container" style="position: relative; height:80vh; width:80vw">
        <canvas id="myChart"></canvas>
    </div>
  </div>

    
		

	  


    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  

  


	<script>
		    labels=[]
        datal=[]   
        $.ajax({
                 url: "https://egeqhlb3ai.execute-api.us-west-2.amazonaws.com/v1/get-new-api",
                 type: 'GET',
                 success: function(res) {
                  res.sort(function (a, b) {
	                  var dateA = new Date(parseInt(a.ts)), dateB = new Date(parseInt(b.ts))
	                  return dateA - dateB
                  });
                         res.forEach(function(item){
                             var myDate=new Date(parseInt(item.ts));
                             labels.push(myDate.toLocaleString());
                             datal.push(parseInt(item.audiolevel)-90);
                         });
                         console.log(labels);
                         console.log(datal);
                        }
               });
  const data = {
  labels: labels,
  datasets: [{
    label: 'Average sensor value data',
    backgroundColor: 'pink',
    borderColor: 'green',
    data: datal
  }]
};

		const config = {
  type: 'line',
  data: data,
  responsive: true,
  options: {
      
    }
  
};


const myChart = new Chart(
    document.getElementById('myChart'),
    config
  );
		
	</script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  </body>
</html>